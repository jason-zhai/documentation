/**
 * Confluence core analytics bindings that should be loaded on all pages (e.g. for content generated by a re-usable
 * velocity macro).
 */
require(['jquery', 'confluence-analytics-support'], function($, Analytics) {
    $(function() {
        function bindViewHistoricalVersionEvent(containerSelector, src) {
            $(containerSelector).on('click', '.view-historical-version-trigger', function() {
                Analytics.publish('confluence.page.view-historical.from-' + (src || 'unknown'));
            })
        }

        function bindRestoreHistoricalVersionEvent(containerSelector, src) {
            $(containerSelector).on('click', '.restore-historical-version-trigger', function() {
                Analytics.publish('confluence.page.restore-historical.from-' + (src || 'unknown'));
            })
        }

        bindViewHistoricalVersionEvent('#page-history-warning', 'navigation');
        bindViewHistoricalVersionEvent('#page-history-container', 'history');
        bindViewHistoricalVersionEvent('.diff-menu', 'diff');

        bindRestoreHistoricalVersionEvent('#page-history-warning', 'navigation');
        bindRestoreHistoricalVersionEvent('#page-history-container', 'history');
    });
});