require(["jquery"],function(b){var d=Backbone.Model.extend({initialize:function(){this.set("cid",this.cid)},getProduct:function(){return this.get("_platform")},getPluginKeys:function(){var e=this.get("_plugins");return _.pluck(e,"key").join(",")}});var a=Backbone.Collection.extend({model:d,url:"/confluence/setup/getbundles.action",setSelectedBundle:function(f){var e=this.get(f);if(e){this.selectedBundle=e;this.trigger("bundleSelected",e)}}});var c=Backbone.View.extend({events:{"click .bundle":"onBundleClick"},el:"#bundle-selector",initialize:function(){this.collection.on("reset",this.renderBundles,this);this.collection.on("error",this.renderLoadingError,this)},renderBundles:function(){var f=b("#bundle-selector-template").html();var e=_.template(f,{bundles:this.collection.toJSON()});this.$el.html(e);this.selectFirstBundle()},renderLoadingError:function(){var e=b("#loading-error-template").html();b("#bundle-selector .loading").html(_.template(e))},selectFirstBundle:function(){var e=this.$(".bundle:first");this.selectBundle(e)},onBundleClick:function(g){var f=b(g.currentTarget);this.selectBundle(f)},selectBundle:function(e){e.siblings().removeClass("active");e.addClass("active");var f=e.data("cid");this.collection.setSelectedBundle(f)}});b(function(){var f=new a();var e=new c({collection:f});f.fetch({reset:true});f.on("bundleSelected",function(g){b("[name=product]").val(g.getProduct());b("[name=pluginKeys]").val(g.getPluginKeys())});b("#setup-package-button").attr("disabled","disabled");f.on("bundleSelected",function(){b("#setup-package-button").attr("disabled",null)})})});